"use strict";(()=>{var e={};e.id=305,e.ids=[305],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2824:e=>{e.exports=require("next/server")},4770:e=>{e.exports=require("crypto")},4575:(e,t,r)=>{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>_});var s={};r.r(s),r.d(s,{GET:()=>p,POST:()=>u});var o=r(1802),a=r(7153),n=r(6249),i=r(2824),c=r(8916);async function p(e){try{let e=(0,c.z)().getMetrics(),t={timestamp:new Date().toISOString(),webhook_client:{...e,url:process.env.N8N_INGEST_URL?"configured":"missing",secret:process.env.WEBHOOK_SECRET?"configured":"missing",tenant_id:process.env.CAPSIGHT_TENANT_ID||"default"},health:{circuit_breaker_state:e.circuit_breaker.state,overall:"CLOSED"===e.circuit_breaker.state?"healthy":"degraded"}};return i.NextResponse.json(t,{headers:{"Cache-Control":"no-cache, must-revalidate"}})}catch(e){return console.error("Webhook metrics error:",e),i.NextResponse.json({error:"Failed to retrieve webhook metrics",timestamp:new Date().toISOString()},{status:500})}}async function u(e){try{let e=(0,c.z)(),t={schema_version:"1.0",type:"valuation.upsert",tenant_id:process.env.CAPSIGHT_TENANT_ID||"default",as_of:new Date().toISOString().split("T")[0],model:{name:"CapSight-Valuation-Engine",version:"1.0.2"},provenance:{macro:{source:"test",as_of:new Date().toISOString(),from_cache:!1},fundamentals:{source:"test",as_of:new Date().toISOString()},comps:{source:"test",as_of:new Date().toISOString()}},address:"Test Property - 123 Main St",geo:{lat:32.7767,lon:-96.797,market:"DFW",submarket:"Downtown"},property_snapshot:{building_sf:5e4,year_built:2020},inputs:{asset_type:"office",rent_psf_yr:28.5,opex_psf_yr:8.5,vacancy_pct:.08,cap_rate_now_pct:6.5,cap_rate_qoq_delta_bps:-25},current_value:{point:215e5,low:1935e4,high:2365e4,confidence:.78},forecast_12m:{point:22575e3,low:20318e3,high:24833e3,confidence:.65},drivers:["Market cap rate: 6.25%","Fed funds adjustment: +15bps","8 comparable sales","NOI: $1,400,000"]},r=await e.send(t,"test-webhook-"+Date.now());return i.NextResponse.json({test_result:r,metrics:e.getMetrics(),timestamp:new Date().toISOString()})}catch(e){return console.error("Test webhook error:",e),i.NextResponse.json({error:"Failed to send test webhook",timestamp:new Date().toISOString()},{status:500})}}let l=(0,n.l)(s,"default"),d=(0,n.l)(s,"config"),_=new o.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/webhook/metrics",pathname:"/api/webhook/metrics",bundlePath:"",filename:""},userland:s})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[750],()=>r(4575));module.exports=s})();